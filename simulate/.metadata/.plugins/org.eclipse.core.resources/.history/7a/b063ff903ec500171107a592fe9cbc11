package circuit;

import java.util.ArrayList;

public class SeriesCircuit
{
	private Element elem[]; //配置されている素子
	private double RSum;
	private double LSum;
	private double CinvSum;
	private double voltage;
	private ArrayList<Double> iList;

	public SeriesCircuit()
	{
		this.elem = new Element[6];
		this.RSum = 0;
		this.LSum = 0;
		this.CinvSum = 0;
		this.voltage = 0;
		iList = new ArrayList<Double>();
	}

	public void setVoltage(double E)
	{
		this.voltage = E;
	}
	
	public void setElem(int num, double value, ElemType et)
	{
		this.elem[num] = new Element(value, et);
	}
	
	public void setElem(int num, Element elem)
	{
		this.elem[num] = elem;
	}
	
	public void elemSum()
	{
		RSum = 0;
		CinvSum = 0;
		LSum = 0;

		for(Element elem : elem)
		{
			switch(elem.getEt())
			{
				case RESISTANCE:
					RSum += elem.getValue();
					break;

				case CAPACITANCE:
					CinvSum += 1 / elem.getValue();
					break;

				case INDUCTANCE:
					LSum += elem.getValue();
					break;
			}
		}
	}

	public void calcCurrent(double start, double end)
	{
		double dt = 0.01;
		double i = 0;
		double iSum = 0;
		int times = (int)((end - start) / dt);
		
		elemSum();
		
		iList.add(0.0);
		
		for(int j = 0;j < times;j++)
		{
			i = (voltage + LSum * i / dt - iSum / CinvSum) / (RSum + LSum * dt + dt / CinvSum);
			iList.add(i);
			iSum += i * dt;
		}
	}
}
